{% extends '../http/index.html' %}
{% block head %}
<link rel="stylesheet" type="text/css" href="register.css">
{% end %}
{% block content %}
<form class="form-register">
	<h2>線上報名系統</h2>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th colspan="2">基本資料</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>姓名<font color=red>*</font></td>
				<td><input type="text" class="form-control name"></input></td>
			</tr>
			<tr>
				<td>職稱<font color=red>*</font></td>
				<td>
					<input type="radio" name="title" value="Prof.">Prof.</input>
					<input type="radio" name="title" value="Dr.">Dr.</input>
					<input type="radio" name="title" value="Mr.">Mr.</input>
					<input type="radio" name="title" value="Mrs.">Mrs.</input>
					<input type="radio" name="title" value="Ms.">Ms.</input>
				</td>
			</tr>
			<tr>
				<td>學校(公司)全銜<font color=red>*</font></td>
				<td><input type="text" class="form-control affiliation"></input></td>
			</tr>
			<tr>
				<td>系所(單位)<font color=red>*</font></td>
				<td><input type="text" class="form-control department"></input></td>
			</tr>
			<tr>
				<td>地址<font color=red>*</font></td>
				<td><input type="text" class="form-control address"></input></td>
			</tr>
			<tr>
				<td>郵遞區號<font color=red>*</font></td>
				<td><input type="text" class="form-control postcode"></input></td>
			</tr>
			<tr>
				<td>E-mail<font color=red>*</font></td>
				<td><input type="text" class="form-control email"></input></td>
			</tr>
			<tr>
				<td>電話/手機<font color=red>*</font></td>
				<td><input type="text" class="form-control phone"></input></td>
			</tr>
			<tr>
				<td>台灣化工會會員<font color=red>*</font></td>
				<td>
					<input type="radio" name="member" value="1">是</input>
					<input type="radio" name="member" value="0">否</input>
				</td>
			</tr>
		</tbody>
	</table>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th colspan="5">年會報名<font color=red>*</font></th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td colspan="2">類別</td>
				<td style="width:28%;">2015/8/31前上網報名並完成繳費</td>
				<td style="width:30%;">2015/9/1後至10/31上網報名並完成繳費</td>
				<td style="width:28%;">現場報名繳費(11/5~7)</td>
			</tr>
			<tr class="0">
				<td><input type="radio" name="package" value="0"></input></td>
				<td>一般會員</td>
				<td class="0">1500 元</td>
				<td class="1">2000 元</td>
				<td class="2">2500 元</td>
			</tr>
			<tr class="1">
				<td><input type="radio" name="package" value="1"></input></td>
				<td>非會員</td>
				<td class="0">2000 元</td>
				<td class="1">2500 元</td>
				<td class="2">3000 元</td>
			</tr>
			<tr class="2">
				<td><input type="radio" name="package" value="2"></input></td>
				<td>學生會員</td>
				<td class="0">800 元</td>
				<td class="1">1000 元</td>
				<td class="2">1500 元</td>
			</tr>
			<tr class="3">
				<td><input type="radio" name="package" value="3"></input></td>
				<td>學生</td>
				<td class="0">1000 元</td>
				<td class="1">1500 元</td>
				<td class="2">2000 元</td>
			</tr>
			<tr>
				<td><input type="checkbox" name="banquet" value="0"></input></td>
				<td><strong>晚宴</strong></td>
				<td colspan="3">800 元</td>
			</tr>
			<tr>
				<td>合計</td>
				<td class="total" colspan="4">0 元</td>
			</tr>
		</tbody>
	</table>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th colspan="2">中午便當</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>
					<input type="radio" name="food" value="1">葷</input>
					<input type="radio" name="food" value="0">素</input>
					若有勾擇晚宴請於此處選葷素
				</td>
				<td>
					<input type="checkbox" name="food-date1">11/6</input>
					<input type="checkbox" name="food-date2">11/7</input>
				</td>
			</tr>
		</tbody>
	</table>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th colspan="2">有興趣參加之議程<font color=red>*</font></th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>化工論壇 (可複選)</td>
				<td>
					<input type="checkbox" name="agenda" value="1">1.頁岩油、氣對台灣石化產業之影響</input>
				</td>
			</tr>
			<tr>
				<td>論文主題 (可複選)</td>
				<td>
					<input type="checkbox" name="paper" value="A">A.生化及生醫工程</input>
					<input type="checkbox" name="paper" value="B">B.輸送現象及分離技術</input>
					<input type="checkbox" name="paper" value="C">C.熱力及界面工程</input>
					<br />
					<input type="checkbox" name="paper" value="D">D.CO2 Capture and Utilization</input>
					<input type="checkbox" name="paper" value="E">E.材料在化工上的應用</input>
					<input type="checkbox" name="paper" value="F">F.電化學技術</input>
					<br />
					<input type="checkbox" name="paper" value="G">G.綠色化工技術及程序工程</input>
					<input type="checkbox" name="paper" value="H">H.觸媒及反應工程</input>
					<input type="checkbox" name="paper" value="I">I.學生英語專題報告競賽</input>
				</td>
			</tr>
		</tbody>
	</table>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th colspan="2">繳費方式</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>轉帳帳號後五碼<font color=red>*</font></td>
				<td><input type="text" class="form-control transnum"></input></td>
			</tr>
			<tr>
				<td>收據抬頭<font color=red>*</font></td>
				<td>
					<select class="form-control invoice">
						<option value="國立政治大學">國立政治大學</option>
						<option value="國立清華大學">國立清華大學</option>
						<option value="國立臺灣大學">國立臺灣大學</option>
						<option value="國立臺灣師範大學">國立臺灣師範大學</option>
						<option value="國立成功大學">國立成功大學</option>
						<option value="國立中興大學">國立中興大學</option>
						<option value="國立交通大學">國立交通大學</option>
						<option value="國立中央大學">國立中央大學</option>
						<option value="國立中山大學">國立中山大學</option>
						<option value="國立臺灣海洋大學">國立臺灣海洋大學</option>
						<option value="國立中正大學">國立中正大學</option>
						<option value="國立高雄師範大學">國立高雄師範大學</option>
						<option value="國立彰化師範大學">國立彰化師範大學</option>
						<option value="國立陽明大學">國立陽明大學</option>
						<option value="國立臺北大學">國立臺北大學</option>
						<option value="國立嘉義大學">國立嘉義大學</option>
						<option value="國立高雄大學">國立高雄大學</option>
						<option value="國立東華大學">國立東華大學</option>
						<option value="國立暨南國際大學">國立暨南國際大學</option>
						<option value="國立臺灣科技大學">國立臺灣科技大學</option>
						<option value="國立雲林科技大學">國立雲林科技大學</option>
						<option value="國立屏東科技大學">國立屏東科技大學</option>
						<option value="國立臺北科技大學">國立臺北科技大學</option>
						<option value="國立高雄第一科技大學">國立高雄第一科技大學</option>
						<option value="國立高雄應用科技大學">國立高雄應用科技大學</option>
						<option value="國立臺北藝術大學">國立臺北藝術大學</option>
						<option value="國立臺灣藝術大學">國立臺灣藝術大學</option>
						<option value="國立臺東大學">國立臺東大學</option>
						<option value="國立宜蘭大學">國立宜蘭大學</option>
						<option value="國立聯合大學">國立聯合大學</option>
						<option value="國立虎尾科技大學">國立虎尾科技大學</option>
						<option value="國立高雄海洋科技大學">國立高雄海洋科技大學</option>
						<option value="國立臺南藝術大學">國立臺南藝術大學</option>
						<option value="國立臺南大學">國立臺南大學</option>
						<option value="國立臺北教育大學">國立臺北教育大學</option>
						<option value="國立新竹教育大學">國立新竹教育大學</option>
						<option value="國立臺中教育大學">國立臺中教育大學</option>
						<option value="國立澎湖科技大學">國立澎湖科技大學</option>
						<option value="國立勤益科技大學">國立勤益科技大學</option>
						<option value="國立體育大學">國立體育大學</option>
						<option value="國立臺北護理健康大學">國立臺北護理健康大學</option>
						<option value="國立高雄餐旅大學">國立高雄餐旅大學</option>
						<option value="國立金門大學">國立金門大學</option>
						<option value="國立臺灣體育運動大學">國立臺灣體育運動大學</option>
						<option value="國立臺中科技大學">國立臺中科技大學</option>
						<option value="國立屏東大學">國立屏東大學</option>
						<option value="國立臺北商業大學">國立臺北商業大學</option>
						<option value="國立臺灣戲曲學院">國立臺灣戲曲學院</option>
						<option value="東海大學">東海大學</option>
						<option value="輔仁大學">輔仁大學</option>
						<option value="東吳大學">東吳大學</option>
						<option value="中原大學">中原大學</option>
						<option value="淡江大學">淡江大學</option>
						<option value="中國文化大學">中國文化大學</option>
						<option value="逢甲大學">逢甲大學</option>
						<option value="靜宜大學">靜宜大學</option>
						<option value="長庚大學">長庚大學</option>
						<option value="元智大學">元智大學</option>
						<option value="中華大學">中華大學</option>
						<option value="大葉大學">大葉大學</option>
						<option value="華梵大學">華梵大學</option>
						<option value="義守大學">義守大學</option>
						<option value="世新大學">世新大學</option>
						<option value="銘傳大學">銘傳大學</option>
						<option value="實踐大學">實踐大學</option>
						<option value="朝陽科技大學">朝陽科技大學</option>
						<option value="高雄醫學大學">高雄醫學大學</option>
						<option value="南華大學">南華大學</option>
						<option value="真理大學">真理大學</option>
						<option value="大同大學">大同大學</option>
						<option value="南臺科技大學">南臺科技大學</option>
						<option value="崑山科技大學">崑山科技大學</option>
						<option value="嘉藥學校財團法人嘉南藥理大學">嘉藥學校財團法人嘉南藥理大學</option>
						<option value="樹德科技大學">樹德科技大學</option>
						<option value="慈濟學校財團法人慈濟大學">慈濟學校財團法人慈濟大學</option>
						<option value="臺北醫學大學">臺北醫學大學</option>
						<option value="中山醫學大學">中山醫學大學</option>
						<option value="龍華科技大學">龍華科技大學</option>
						<option value="輔英科技大學">輔英科技大學</option>
						<option value="明新科技大學">明新科技大學</option>
						<option value="長榮大學">長榮大學</option>
						<option value="弘光科技大學">弘光科技大學</option>
						<option value="中國醫藥大學">中國醫藥大學</option>
						<option value="健行學校財團法人健行科技大學">健行學校財團法人健行科技大學</option>
						<option value="正修科技大學">正修科技大學</option>
						<option value="萬能學校財團法人萬能科技大學">萬能學校財團法人萬能科技大學</option>
						<option value="玄奘大學">玄奘大學</option>
						<option value="建國科技大學">建國科技大學</option>
						<option value="明志科技大學">明志科技大學</option>
						<option value="高苑科技大學">高苑科技大學</option>
						<option value="大仁科技大學">大仁科技大學</option>
						<option value="聖約翰科技大學">聖約翰科技大學</option>
						<option value="嶺東科技大學">嶺東科技大學</option>
						<option value="中國科技大學">中國科技大學</option>
						<option value="中臺科技大學">中臺科技大學</option>
						<option value="亞洲大學">亞洲大學</option>
						<option value="開南大學">開南大學</option>
						<option value="佛光大學">佛光大學</option>
						<option value="台南家專學校財團法人台南應用科技大學">台南家專學校財團法人台南應用科技大學</option>
						<option value="遠東科技大學">遠東科技大學</option>
						<option value="光宇學校財團法人元培醫事科技大學">光宇學校財團法人元培醫事科技大學</option>
						<option value="景文科技大學">景文科技大學</option>
						<option value="中華醫事科技大學">中華醫事科技大學</option>
						<option value="東南科技大學">東南科技大學</option>
						<option value="德明財經科技大學">德明財經科技大學</option>
						<option value="明道學校財團法人明道大學">明道學校財團法人明道大學</option>
						<option value="康寧大學">康寧大學</option>
						<option value="南開科技大學">南開科技大學</option>
						<option value="中華學校財團法人中華科技大學">中華學校財團法人中華科技大學</option>
						<option value="僑光科技大學">僑光科技大學</option>
						<option value="廣亞學校財團法人育達科技大學">廣亞學校財團法人育達科技大學</option>
						<option value="美和學校財團法人美和科技大學">美和學校財團法人美和科技大學</option>
						<option value="吳鳳科技大學">吳鳳科技大學</option>
						<option value="環球學校財團法人環球科技大學">環球學校財團法人環球科技大學</option>
						<option value="台灣首府學校財團法人台灣首府大學">台灣首府學校財團法人台灣首府大學</option>
						<option value="中州學校財團法人中州科技大學">中州學校財團法人中州科技大學</option>
						<option value="修平學校財團法人修平科技大學">修平學校財團法人修平科技大學</option>
						<option value="長庚學校財團法人長庚科技大學">長庚學校財團法人長庚科技大學</option>
						<option value="興國管理學院">興國管理學院</option>
						<option value="大華學校財團法人大華科技大學">大華學校財團法人大華科技大學</option>
						<option value="文藻學校財團法人文藻外語大學">文藻學校財團法人文藻外語大學</option>
						<option value="大漢技術學院">大漢技術學院</option>
						<option value="慈濟學校財團法人慈濟技術學院">慈濟學校財團法人慈濟技術學院</option>
						<option value="和春技術學院">和春技術學院</option>
						<option value="城市學校財團法人臺北城市科技大學">城市學校財團法人臺北城市科技大學</option>
						<option value="致理技術學院">致理技術學院</option>
						<option value="醒吾學校財團法人醒吾科技大學">醒吾學校財團法人醒吾科技大學</option>
						<option value="亞東技術學院">亞東技術學院</option>
						<option value="桃園創新科技學校財團法人桃園創新技術學院">桃園創新科技學校財團法人桃園創新技術學院</option>
						<option value="稻江科技暨管理學院">稻江科技暨管理學院</option>
						<option value="德霖技術學院">德霖技術學院</option>
						<option value="南榮學校財團法人南榮科技大學">南榮學校財團法人南榮科技大學</option>
						<option value="蘭陽技術學院">蘭陽技術學院</option>
						<option value="黎明技術學院">黎明技術學院</option>
						<option value="東方學校財團法人東方設計學院">東方學校財團法人東方設計學院</option>
						<option value="經國管理暨健康學院">經國管理暨健康學院</option>
						<option value="崇右技術學院">崇右技術學院</option>
						<option value="大同技術學院">大同技術學院</option>
						<option value="亞太學校財團法人亞太創意技術學院">亞太學校財團法人亞太創意技術學院</option>
						<option value="華夏學校財團法人華夏科技大學">華夏學校財團法人華夏科技大學</option>
						<option value="臺灣觀光學院">臺灣觀光學院</option>
						<option value="台北海洋技術學院">台北海洋技術學院</option>
						<option value="馬偕醫學院">馬偕醫學院</option>
						<option value="法鼓學校財團法人法鼓文理學院">法鼓學校財團法人法鼓文理學院</option>
						<option value="學校財團法人中華浸信會基督教台灣浸會神學院">學校財團法人中華浸信會基督教台灣浸會神學院</option>
						<option value="臺北基督學院">臺北基督學院</option>
						<option value="臺北市立大學">臺北市立大學</option>
						<option value="國立空中大學">國立空中大學</option>
						<option value="高雄市立空中大學">高雄市立空中大學</option>
						<option value="中華民國陸軍軍官學校">中華民國陸軍軍官學校</option>
						<option value="海軍軍官學校">海軍軍官學校</option>
						<option value="中華民國空軍軍官學校">中華民國空軍軍官學校</option>
						<option value="國防大學">國防大學</option>
						<option value="中央警察大學">中央警察大學</option>
						<option value="國防醫學院">國防醫學院</option>
						<option value="國立空軍航空技術學院">國立空軍航空技術學院</option>
						<option value="other">其他</option>
					</select>
				</td>
			</tr>
			<tr class="o-invoice">
				<td>其他抬頭<font color=red>*</font></td>
				<td><input type="text" class="form-control o-invoice"></input></td>
			</tr>
			<tr>
				<td>統一編號<font color=red>*</font></td>
				<td><input type="text" class="form-control vat"></input></td>
			</tr>
		</tbody>
	</table>
	<button type="button" class="btn btn-primary submit" style="float: left;">送出</button>
	<div style="float: left;padding-left: 10px; padding-top: 5px; font-size: 16px; color:#F00" class="print"></div>
</form>
<script>
$(document).ready(function(){
	var print=$('div.print');
	var package=$('input[name=package]');
	var banquet=$('input[name=banquet]');
	var total=$('td.total');
	var date1=new Date('2015/10/10');
	var date2=new Date('2015/10/20');
	function update_money(){
		var pkg=$('input[name=package]:checked').val();
		var type=0;
		var now=new Date();
		if(now<=date1)type=0;
		else if(now<=date2)type=1;
		else type=2;
		var money=pkg?parseInt($('tr.'+pkg).find('td.'+type).text().split(' ')[0],10):0;
		if(banquet.prop('checked')){
			money+=800;
		}
		total.text(money+' 元');
	}
	package.change(function(){
		update_money();	
	});
	banquet.change(function(){
		update_money();
	});
	var agenda='';
	var paper='';
	var submit=$('button.submit');
	$('tr.o-invoice').hide();
	$('select.invoice').change(function(){
		if($(this).val()=='other'){
			$('tr.o-invoice').show();
		}else{
			$('tr.o-invoice').hide();
		}
	});
	$('input[name=agenda]').change(function(){
		var tmp='';
		$('input[name=agenda]').each(function(){
			if($(this).prop('checked')){
				tmp+=$(this).val()+' ';
			}
		});
		agenda=tmp;
	});
	$('input[name=paper]').change(function(){
		var tmp='';
		$('input[name=paper]').each(function(){
			if($(this).prop('checked')){
				tmp+=$(this).val()+' ';
			}
		});
		paper=tmp;
	});
	submit.click(function(){
		var name=$('input.name').val();
		var title=$('input[name=title]:checked').val();
		var affiliation=$('input.affiliation').val();
		var department=$('input.department').val();
		var address=$('input.address').val();
		var postcode=$('input.postcode').val();
		var email=$('input.email').val();
		var phone=$('input.email').val();
		var fax=$('input.fax').val();
		var cellphone=$('input.cellphone').val();
		var member=$('input[name=member]:checked').val();
		var food=$('input[name=food]:checked').val()||-1;
		var food_date1=$('input[name=food-data1]').prop('checked');
		var food_date2=$('input[name=food-data2]').prop('checked');
		var transnum=$('input.transnum').val();
		var transmulti=$('input.transmulti').prop('checked');
		var invoice=$('select.invoice').val();
		var o_invoice=$('input.o-invoice').val();
		var vat=$('input.vat').val();
		if(invoice=='other')
			invoice=o_invoice;
		if(name==''){
			print.text('請輸入姓名');
			return;
		}else if(typeof(title)=='undefined'){
			print.text('請選擇職稱');
			return;
		}else if(affiliation==''){
			print.text('請輸入學校(公司)全銜');
			return;
		}else if(department==''){
			print.text('請輸入系所(單位)');
			return;
		}else if(address==''){
			print.text('請輸入地址');
			return;
		}else if(postcode==''){
			print.text('請輸入郵遞區號');
			return;
		}else if(email==''){
			print.text('請輸入E-mail');
			return;
		}else if(phone==''){
			print.text('請輸入電話');
			return;
		}else if(fax==''){
			print.text('請輸入傳真');
			return;
		}else if(cellphone==''){
			print.text('請輸入手機');
			return;
		}else if(typeof(member)=='undefined'){
			print.text('請選擇是否為會員');
			return;
		}else if((banquet.prop('checked')||food_date1||food_date2)&&typeof(food)=='undefuned'){
			print.text('請輸入食物葷素');
			return;
		}else if(transnum==''){
			print.text('請輸入轉帳帳號後五碼');
			return;
		}else if(transnum.match(/\d*/i)!=transnum||transnum.length!=5){
			print.text('請確認轉帳帳號後五碼');
			return;
		}else if(invoice==''){
			print.text('請輸入其他抬頭名稱');
			return;
		}
		$.post('/indivisualreg',{
			'name':name,
			'title':title,
			'affiliation':affiliation,
			'department':department,
			'address':address,
			'postcode':postcode,
			'email':email,
			'phone':phone,
			'fax':fax,
			'cellphone':cellphone,
			'member':member,
			'package':$('input[name=package]:checked').val(),
			'banquet':banquet.prop('checked')?1:0,
			'total':total.text().split(' ')[0],
			'food':food,
			'food_date1':food_date1?'1':'0',
			'food_date2':food_date2?'1':'0',
			'agenda':agenda,
			'paper':paper,
			'transnum':transnum,
			'transmulti':transmulti?'1':'0',
			'invoice':invoice,
			'vat':vat,
		},function(res){
			if(res=='Eexistname'){
				print.text('此姓名已註冊');
            }else if(res == 'Eexistemail'){
                print.text('此Email已被註冊過');
            }else if(res[0]=='E'){
				print.text('Something Wrong');
			}else{
				alert('您的報名編號為 '+res);
                window.location = '/';
			}
		});
	});
});
</script>
{% end %}
